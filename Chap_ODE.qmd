---
title: "Ordinary Differential Equations and their application in Ecology"
bibliography: references.bib
author: "Amélie Cocchiara, Anastasia Paupe, Clément Monaury, Laura Martinez Anton, Theo Laguillez"
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
editor: 
  markdown: 
    wrap: 72
---

```{r}
#Add packages
library(tidyverse)
```

Introduce objectifs of the chapter

I. Dynamics systems (definition)

II. Ordinary differential equation

<!-- -->

1)  Definition
2)  1-equation system

<!-- -->

III. 2-equations system

# **IV. 3-equation system**

## 1) SIR model :

The most used models in epidemiology are mathematical models of
infectious diseases such as the SIR model. These models are based on
compartmentalization that divide the population into various possible
disease states. The SIR model is composed of 3 compartments: initially
healthy or susceptible individuals (S), infected individuals (I) and
cured individuals or resistent (R).

$$ SIR=\begin{cases}\frac{d_S}{d_t}=\alpha SI-\gamma R &\text{Susceptible} \\ \frac{d_I}{d_t}=\alpha SI-\beta I&\text{Infected} \\ \frac{d_R}{d_t}=\beta I- \gamma R &\text{Resistent}\end{cases} $$

We assume a closed population, so :
$$ S+I+R = 1 \Leftrightarrow R=1-S-I $$

Thus, we can express R from S and I, so we can remove the equation from
our system and we end up with a system with 2 equations.

We look for balance points such as:

$$ SIR=\begin{cases}\frac{d_S}{d_t}=0 &\text{Susceptible} \\ \frac{d_I}{d_t}=0&\text{Infected} \end{cases} $$

To do this, we solve :

$$ \begin{cases}\alpha SI-\gamma R = 0 &\text{Susceptible} \\ \alpha SI-\beta I =0 &\text{Infected} \end{cases} $$

We change the R :

$$\begin{cases}\alpha SI-\gamma (1-S-I) = 0 &\text{Susceptible} \\ \alpha SI-\beta I =0 &\text{Infected}\end{cases} $$

We first focus on solving:

$$\Leftrightarrow I(\alpha S- \beta) =0 \Leftrightarrow  I(\alpha S- \beta) =0 \\ \Leftrightarrow I=0\ or\  S= \frac{\beta}{\alpha}$$

If *I = 0*, we integrate I=0 into our "susceptible" equation to obtain
the solution for S:

$$ \alpha S *0 + \gamma (1-S-0)=0 \\ \Leftrightarrow \gamma (1-S)=0 \\ \Leftrightarrow 1-S=0 \\ \Leftrightarrow S=1$$
We thus obtain our first solution with:
$$ \begin{pmatrix} S \\ I \end{pmatrix} = \begin{pmatrix} 1 \\ 0 \end{pmatrix} $$
If *S = b/a*, we integrate S into our "susceptible" equation to obtain
the solution for I:

$$
\begin{align} 
&\alpha \frac{\beta}{\alpha}I + \gamma (1-\frac{\beta}{\alpha} - I)=0 \\ \Leftrightarrow \ &\beta I + \gamma (1-\frac{\beta}{\alpha}-I)=0 \\ \Leftrightarrow \ &\beta I + \gamma - \frac{\beta}{\alpha} \gamma - \gamma I = 0 \\ \Leftrightarrow \ &\beta I - \gamma I = - \gamma + \frac{\beta}{\alpha} \gamma \\ \Leftrightarrow \ &I = \frac{- \gamma + \frac{\beta}{\alpha} \gamma}{\beta - \gamma} \\ \Leftrightarrow \ &I = \frac{1-\frac{\beta}{\alpha}}{b- \gamma} 
\end{align} 
$$

We thus obtain our first solution with:

$$ \begin{pmatrix} S \\ I \end{pmatrix} = \begin{pmatrix} \frac{\beta}{\alpha} \\ \frac{1-\frac{\beta}{\alpha}}{\beta - \gamma} \end{pmatrix} $$

It is then necessary to determine the Jacobian matrix for each
equilibrium pair determined previously.

$$ J=\begin{bmatrix} \frac{\delta S}{\delta S} & \frac{\delta S}{\delta I} \\ \frac{\delta I}{\delta S} & \frac{\delta I}{\delta I}  \end{bmatrix} \Leftrightarrow \begin{bmatrix} \alpha I- \gamma & \alpha S- \gamma \\ \alpha I & \alpha S- \beta \end{bmatrix} $$


For the couple, S=1 and R=0 :

$$ J(1,0)= \begin{bmatrix} -\gamma & \alpha -\gamma \\ 0 & \alpha - \beta) \end{bmatrix} $$

We seek to determine the solutions of the characteristic equation :

$$det(J- \lambda Id)=0$$

with *Id* = identity matrix (cf matrix calculation).

The solutions of the characteristic equation are the eigenvalues :

$$det(1,0)=det \begin{bmatrix} -\gamma -\lambda & \alpha - \gamma \\ 0 & \alpha - \beta - \lambda \end{bmatrix} $$
$$det \begin{bmatrix} -\gamma -\lambda & \alpha - \gamma \\ 0 & \alpha - \beta - \lambda \end{bmatrix} =0 \\ 
\text{Les solutions sont les valeurs propres. Ici, la matrice Jacobienne est triangulaire, donc}
\\ \text{Les valeurs propres sont les éléments diagonaux.}
\\ sp(J)=\{ -\gamma -\lambda ; \alpha - \beta - \lambda \}  $$

To obtain the solutions of the polynomials :

$$ \begin{align} &\Delta = (\alpha - \beta -\gamma)^2 - 4 \gamma (\beta - \alpha)
\\ If: \ &\Delta > 0 : \text{two distinct real roots}
\\ &\Delta = 0 : \text{one real repeated root}
\\ &\Delta < 0 : \text {two complex conjugate roots} \end{align} $$

$$ J(\frac{\beta}{\alpha}, \frac{1- \frac{\beta}{\alpha}}{\beta -\gamma})= \begin{bmatrix} \frac{\alpha -\beta}{\beta -\gamma}-\gamma & \beta -\gamma \\ \frac{\alpha - \beta}{\beta - \gamma} & 0 \end{bmatrix}
\\ det(J- \lambda Id)= \begin{bmatrix} \frac{\alpha - \beta}{\beta - \gamma} -\gamma -\lambda & \beta - \gamma \\ \frac{\alpha - \beta}{\beta - \gamma} & -\lambda \end{bmatrix}=0
\\
\Leftrightarrow (\frac{\alpha -\beta}{\beta -\gamma})(-\lambda) -( \frac{\alpha - \beta}{\beta - \gamma})(\beta - \gamma)=0 
\\
\Leftrightarrow \lambda ^2 + \lambda (\gamma - \frac{\alpha - \beta}{\beta -\gamma})-\frac{(\alpha -\beta)\beta}{\beta - \gamma} + \frac{(\alpha -\beta)\gamma}{\beta - \gamma}=0
\\ \text{Same logic as before :}
\\ \Delta = (\gamma - \frac{\alpha - \beta}{\beta -\gamma})^2-4( \frac{( \alpha -\beta) \beta}{\beta -\gamma}+ \frac{(\alpha - \beta) \gamma}{\beta - \gamma})$$



## 1) Lotka-Volterra : A three-species model

Biotic interactions are complex, requiring the interaction of numerous
parameters. If we take the **Lotka-Volterra** example, it only considers
the **interactions between two species**, prey and predator. It assumes
a constant mortality rate among predators, regardless of prey. However,
**predators are themselves the prey of other super-predators**. Their
mortality rate should therefore depend on the super-predators they
encounter. Thus, the **prey-predator-superpredator** extension of the
Lotka-Volterra model would be a good representation of natural trophic
interactions.

In this case, we considerer a superpredator, a predator an a prey.

A superpredator is an organism that reaches adulthood at the top of the
food chain. Thus, by definition, a superpredator is not the prey of any
other species. The predator is consider to be in the middle of the food
chain and the prey at the bottom.

The model can be written as the following system of differential
equations:

$$ PPS=\begin{cases}\frac{d_x}{d_t}=ax-bxy &\text{Prey} \\ \frac{d_y}{d_t}=-cy+dxy-eyz&\text{Predator} \\ \frac{d_z}{d_t}=-fz+gyz &\text{Superpredator}\end{cases} $$

The model parameters are :

-   *a* : *x* natural growth rate

-   *-f* and *-c* : natural death rate of *y* and *z*

-   The growth rate of *y* and *z* depends on the number of prey caught.
    It is modeled by *dxy* for *y* and by *gyz* for *z*.

-   The death rate of *x* and *y* depends on the number of top predators
    *y* for *x* and *z* for *y* . It is modeled by *-bxy* for *x* and by
    *-eyz* for *y*.

This model is only useful for chains of predators. It doesn't take into
account the presence of several predators with different dynamics on the
same prey.

Let's try to solve this system: To do this, the first step is to find
the balance of the model, that is to say the values (x,y,z) so that:

$$\frac{d_x}{d_t}=\frac{d_y}{d_t}=\frac{d_z}{d_t}=0$$

We take our previous systems that we factored:

$$ PPS=\begin{cases}\frac{d_x}{d_t}=x(a-by) &\text{Prey} \\ \frac{d_y}{d_t}=y(dxy-c-ez)&\text{Predator} \\ \frac{d_z}{d_t}=z(gy-f) &\text{Superpredator}\end{cases} $$

The obvious solution is (0,0,0) but is not the only one. Indeed, for the
derivatives to be equal to 0, then we must find the following solution:

$$(a-by)=(gy-f)=(dx-c-ez)=0$$

We first solve :
$$a-by=0\Leftrightarrow a=by \Leftrightarrow y=\frac{a}{b}$$
$$gy-f=0\Leftrightarrow f=by \Leftrightarrow y=\frac{f}{g}$$ So, a
solution for a yeq is: $$y_{eq}=\frac{a}{b}=\frac{f}{g}$$ Therefore,
there is an equilibrium when : $$ga=fb$$

In order to determine the other solutions, we must solve the following
matrix :
$$ M=\begin{bmatrix}a-by&-bx&0\\dy&-c+dx-ez&-ey\\0&gz&gy-f\end{bmatrix}$$

We invite you to look at the chapter on matrix calculation to determine
the solutions.

**But don't panic** ! In ecology we are lucky to have a great tool, R,
which allows us to resolve this type of system.

## 2) Resolution under R

## 3) Generalizations of the three-species model and other examples

The three-species model presented previously is a simplified model that
models a perfectly linear trophic chain. However, nature is more complex
and a species can be preyed upon by multiple predators and predators can
predate multiple prey items.

We invite you to go see the course of Lalith Devireddy (2016) entitled
"Extending the Lotka-Volterra Equations" which develops this model and
its resolutions.

Many models with 3-ODE systems exist to model ecological dynamics. Here
we will present two additional ones to you but we will not develop their
resolution.

### a) NPZ model

The NPZ model makes it possible to model the lake production of a
pelagic ecosystem. This model studies variations in nutrients,
phytoplankton and phytoplankton that are linked to each other.

V. Ecological example of the use of ODE #Model NPZ & Growth model =\>
How the production of the environment affect the growth of an organism ?

VI. Second & Third-order ODE

<!-- -->

1.  Definition

2.  How to resolve them ?

<!-- -->

a)  Analytic solutions An analytic solutions for an ODE is an expression
    that represents the solution using a finite number of elementary
    functions (exponential, logarithmic...). It provides a precise
    mathematical formula that describes the behavior of the solution for
    all values of the independent variable within a certain range.
    Finding general analytical solutions for third-order ODEs can be
    complicated and often depends on the specific form of the equation.
    Sometimes, they may not exist, and in this case numerical methods
    might be more appropriate.

b)  Numerical methods : Introduction to Euler's method & Runge-Kutta The
    choice of numerical method depends on the specific characteristics
    of the ODE system.

Conclusion & motivation words
