---
title: "Partie 4 - L'éternel déménagement"
author: "Quentin"
date: "2023-11-15"
output: html_document
---

Après ce nouveau coup dur et cette épidémie, les survivants de notre famille de suricate sont de nouveau contraints de se mettre en recherche d'un habitat et de rejoindre une nouvelle colonie. Pour ce choix, plusieurs options et colonies s'offrent à eux, chacune avec une probabilité différente d'être rejointe en fonction de la penibilité du trajet et des ressources qu'elle contient :
Tout d'abord, nos pauvres suricates se trouvent en position O et ne peuvent rester à cet endroit. Cependant, ils peuvent gagner une petite colonie proche (colonie A) avec une probabilité d'y arriver de 0.9 ou une colonie plus lointaine (colonie C) avec une probabilité d'y arriver de 0.1. 
Une fois dans la colonie A, ils ont une probabilité de 0.6 d'être acceptés puis de s'y installer définitivement dans le terrier A1 et une probabilité de 0.4 de rejoindre un autre colonie proche (colonie B). 
Dans cette colonie B, les suricates ont une probabilité de 0.7 d'être acceptés par leurs congénères pour s'installer définitivement dans le terrier B2. Si ce n'est pas le cas, ils possèdent une probabilité de 0.1 de revenir à la colonie A retenter leur chance ou de 0.2 d'atteindre la colonie C.
Si les suricates atterissent dans la colonie C, ceux-ci auront une probabilité de 0.8 d'être intégrés et de s'y établir définitivement au sein du terrier C3. Dans l'autre cas, une probabilité de 0.025 de revenir à la colonie B ou à la position O et une probabilité de 0.15 de rejoindre une dernière colonie D extrêmement prospère avec une probabilité de 0.9 d'être acceptés et de s'y établir définitivement au sein du terrier D4. 
Si contre toute attente les suricates parviennent à cette dernière colonie mais ne réussissent pas à être acceptés, ceux-ci ont une probabilité de 0.1 de retenter leur chance dans la colonie C. 
# Je pense que le schéma doit être avant le paragraphe et qu'il y a pas besoin de décrire toute les flèche mais d'explique le principe (a quoi correspond une flèche et la probabilité qui est dessus) puis de faire seulement un exemple

![Schéma des péripéties suricatiennes](C:/Users/qlamb/Documents/R/Schema_suricates.png)

# Avant d'introduire directement la matrice de transition faire un point pour expliquer que cette situation est une chaîne de markov (donc définir ce qu'est une chaîne de markov) et dire a quoi ca sert de l'étudier (savoir si on a un etat stable et les probabilités sur le temps long d'être dans les différentes localisation)
Ces différents éléments nous permettent de réaliser une matrice T un peu particulière, que l'on appelle matrice de transition d'une "Chaîne de Markov" dont le schéma figure ci-dessus, définissant les probabilités de transition de chaque état au temps (t) vertical vers chaque état au temps (t+1) horizontal et figurant ci-dessous : 

$$
T=
\left(\begin{array}{cc} 
P(O|O) & P(A|O) & P(A1|O) & P(B|O) & P(B2|O) & P(C|O) & P(C3|O) & P(D|O) & P(D4|O)\\
P(O|A) & P(A|A) & P(A1|A) & P(B|A) & P(B2|A) & P(C|A) & P(C3|A) & P(D|A) & P(D4|A)\\
P(O|A1) & P(A|A1) & P(A1|A1) & P(B|A1) & P(B2|A1) & P(C|A1) & P(C3|A1) & P(D|A1) & P(D4|A1)\\
P(O|B) & P(A|B) & P(A1|B) & P(B|B) & P(B2|B) & P(C|B) & P(C3|B) & P(D|B) & P(D4|B)\\
P(O|B2) & P(A|B2) & P(A1|B2) & P(B|B2) & P(B2|B2) & P(C|B2) & P(C3|B2) & P(D|B2) & P(D4|B2)\\
P(O|C) & P(A|C) & P(A1|C) & P(B|C) & P(B2|C) & P(C|C) & P(C3|C) & P(D|C) & P(D4|C)\\
P(O|C3) & P(A|C3) & P(A1|C3) & P(B|C3) & P(B2|C3) & P(C|C3) & P(C3|C3) & P(D|C3) & P(D4|C3)\\
P(O|D) & P(A|D) & P(A1|D) & P(B|D) & P(B2|D) & P(C|D) & P(C3|D) & P(D|D) & P(D4|D)\\
P(O|D4) & P(A|D4) & P(A1|D4) & P(B|D4) & P(B2|D4) & P(C|D4) & P(C3|D4) & P(D|D4) & P(D4|D4)\\
\end{array}\right)
$$

$$ T=
\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0  & 0 & 0\\
0 & 0 & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0.1 & 0 & 0.7 & 0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0.025 & 0 & 0 & 0.025 & 0 & 0 & 0.8 & 0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right)
$$

Comme nous pouvons le remarquer, cette matrice fonctionne en temps discret du fait du passage du temps t au temps t+1 et de l'absence de période de transition entre les différents compartiments. Cependant, elle pourrait également fonctionner en temps continu à espaces d'état discret.
Par exemple, dans la matrice précédente, nous pouvons lire que la probabilité de passer de la position O (la pauvre tente de camping de notre famille de suricates bien aimés) à la colonie A est de 0.9, soit 90%.

Si on tient compte du fait qu'au temps 0, les suricate sont dans leur tente de fortune :

$$
X_0 =\left(\begin{array}{cc} 
1 & 0 & 0 & 0 & 0 & 0 & 0  & 0 & 0\\
\end{array}\right)
$$
A l'issue du premier pas de temps, nous auront :

$$
X_1 = \left(\begin{array}{cc}
1 & 0 & 0 & 0 & 0 & 0 & 0  & 0 & 0\\
\end{array}\right).\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0  & 0 & 0\\
0 & 0 & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0.1 & 0 & 0.7 & 0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0.025 & 0 & 0 & 0.025 & 0 & 0 & 0.8 & 0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right) = X_0.T
$$
Donc :

$$ 
X_1 =\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0\\
\end{array}\right)
$$
Autrement dit, au bout du premier pas de temps les suricates auront 90% de probabilité de se trouver dans la colonie A et 10% de probabilité de se trouver dans la colonie C.
A l'issue du second pas de temps, nous auront :

$$
X_2 = \left(\begin{array}{cc}
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0\\
\end{array}\right).\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0  & 0 & 0\\
0 & 0 & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0.1 & 0 & 0.7 & 0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0.025 & 0 & 0 & 0.025 & 0 & 0 & 0.8 & 0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right)=X_1.T
$$
Donc :

$$ 
X_2 =\left(\begin{array}{cc} 
0.0025 & 0 & 0.54 & 0.3625 & 0 & 0 & 0.08 & 0.015 & 0\\
\end{array}\right)
$$

A l'issue du second pas de temps, la famille de suricate aura 0.25% de probabilité d'être revenu à son campement initial (position 0), 54% de probabilité d'être accepté par la colonie A, 36.25% de probabilité de se retrouver dans la colonie B, 8% de probabilité d'avoir été accepté dans la colonie C et 1.5% de probabilité d'être d'atteindre la colonie D avec les plus grandes quantités de ressources.
De manière générale, nous pouvons convenir du produit matriciel suivant :

$$
X_t = \left(\begin{array}{cc}
1 & 0 & 0 & 0 & 0 & 0 & 0  & 0 & 0\\
\end{array}\right).\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0  & 0 & 0\\
0 & 0 & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0.1 & 0 & 0.7 & 0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0.025 & 0 & 0 & 0.025 & 0 & 0 & 0.8 & 0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right)^t=X_0.T^t
$$
La théorie de la chaîne de Markov nous dit qu'au bout d'un certain temps, la loi de probabilité sera indépendante de la loi initiale et nous obtiendrons une convergence vers différents points de la chaîne.

Cette convergence est facile à vérifier, en particulier en calculant le vecteur propre de la matrice T :
$$
q.T=q\\
q.T=q.I\\
q(I-T)=0\\
$$
$$
q
\left(\begin{array}{cc}
\left(\begin{array}{cc}
1 & 0 & 0 & 0 & 0 & 0 & 0  & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right)-\left(\begin{array}{cc} 
0 & 0.9 & 0 & 0 & 0 & 0.1 & 0  & 0 & 0\\
0 & 0 & 0.6 & 0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0.1 & 0 & 0.7 & 0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0.025 & 0 & 0 & 0.025 & 0 & 0 & 0.8 & 0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0.1 & 0 & 0 & 0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\end{array}\right)
\end{array}\right)
=0
$$
$$
q.
\left(\begin{array}{cc}
1 & -0.9 & 0 & 0 & 0 & -0.1 & 0  & 0 & 0\\
0 & 1 & -0.6 & -0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & -0.1 & 1 & -0.7 & -0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-0.025 & 0 & 0 & -0.025 & 0 & 1 & -0.8 & -0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & -0.1 & 0 & 1 & -0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\end{array}\right)
=0
$$
$$
\left(\begin{array}{cc} 
λ_1 & λ_2 & λ_3 & λ_4 & λ_5 & λ_6 & λ_7 & λ_8 & λ_9\\
\end{array}\right).
\left(\begin{array}{cc}
1 & -0.9 & 0 & 0 & 0 & -0.1 & 0  & 0 & 0\\
0 & 1 & -0.6 & -0.4 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & -0.1 & 1 & -0.7 & -0.2 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-0.025 & 0 & 0 & -0.025 & 0 & 1 & -0.8 & -0.15 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & -0.1 & 0 & 1 & -0.9\\
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\end{array}\right)
=0 = \left(\begin{array}{cc} 
0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\end{array}\right)
$$

Etant donné qu'aller plus loin "à la main" s'avèrerait particulièrement chronophage, il est également possible d'utiliser le logiciel R :
On crée tout d'abord la matrice :
```{r}
T<-matrix(c(0,0.9,0,0,0,0.1,0,0,0,0,0,0.6,0.4,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0.1,0,0.7,0.2,0,0,0,0,0,0,0,1,0,0,0,0,0.025,0,0,0.025,0,0,0.8,0.15,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0.1,0,0,0.9,0,0,0,0,0,0,0,0,1),ncol=9,nrow=9,byrow=TRUE)
vecP<-eigen(T)
```

