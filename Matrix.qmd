<<<<<<< HEAD
---
title: "Modèle matrice et applications en écologie"
bibliography: "Quentin, Alexie, Jeanne et Laurane"
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---
Plan projet : 

Plan projet : 

Modélisation matricielle en écologie
A quoi servent les matrices en écologie ?
Transformer une population en matrice
Modifier une matrice de population (addition de population,soustraction)

II. Les grands exemples de matrices en écologie  
Classes d’âge et reproduction : Matrice de Leslie
Impact prédateur
Compétition ?

III. Matrice en épidémiologie 

IV. Chaînes de Markov 



Chapitre purment technique ? ou bien les modèles matriciels et on prend des exemples d'écologie et on explique en même temps ?
parler de la dynamique de populations

partir de la population de suricats et on complexifie au fur et à mesure en introduisant les notions 




I. Modélisation matricielle en écologie

	A quoi servent les matrices en écologie ? 
	
Matrices are mathematical tools for modeling situations. Used in many fields, ecology is no exception. Matrices make it possible to represent populations and make them evolve according to different rules or events. 
The first uses of these models date back to 1941 by Harro Bernardelli which studied the oscillations of the structure of a population. Others use later matrices to represent populations, including Leslie in 1945 whose work marked a turning point in the use of matrices in ecology. 
Subsequently, different models of matrix representation of populations were published and used in population dynamics.

The objective of a population matrix is, as we have already said, to represent the evolution of a population over time and its state at a particular time "t" for example, which will be represented as discreet in this chapter. 
This matrix is therefore based on population growth behaviours. Let’s recall the basics to better understand how population matrices were created :

In 1798, Malthus published his population growth model. If we consider N(t) as the population size at time t, and λ the rate of growth of this population, we can write that: 

$$
N(t+1) = λN(t)
$$
If we want to write this equation for the population in a distant future, we can find by recurrence that :

$$
N(t) = λ^tN(0)   
$$
with N(0) the population at the beginning of our study.

Depending on the sign of λ, our population will therefore increase or decrease over time.
However, this model is largely simplified. Why? It considers that all individuals are identical, whether by their reproductive capacity or their ability to survive. 
This means that in this model, an elderly individual can reproduce and survive just as well as a young and vigorous individual who has just reached sexual maturity.

But then, how can we solve this problem? In the wild, each individual is different, but we can predict his qualities according to the average of his species and his position in the population: by position, we mean his place in different categories expressed according to various criteria such as age (young, adult, old), sex (male, female), or many others. 
These categories are commonly referred to as “classes”. Several individuals of the same class will have the same characteristics from the point of view of the criterion used for this class, and therefore will have the same impacts on the dynamics of their population. For example, they will have the same fertility or the same survival rate. Thus, we can determine the contribution of each class to another class and thus ultimately to the population, and this according to the size of the first class. 

The size of a class "i" can thus be written:

$$
\begin{equation*}
n_i(t+1) = \sum_j (a_{ij} \cdot n_j(t))
\end{equation*}
$$ 

Where "a" is the contribution and a_ij the contribution of a class "j" to class "i" at time t+1.
We can then create a system considering all the classes, which can be translated into a matrix:

$$
\begin{equation}
N(t+1) = A \cdot N(t)
\end{equation}
$$  
$$
\begin{equation}
N(t) = A^t \cdot N(0)
\end{equation}
$$ 
Where A is what we call a population projection matrix, representing our population in a matrix form, according to its different characteristics (classes, class parameters, etc.). 
N(t) is a vector dependent on the number of individuals present in our population, and N(0) is our initial population vector, from which we will be able to make this population evolve over time.

Population dynamic is a concept that is sometimes difficult to study because it depends on many parameters. A population will vary in size and type of individuals through four main processes: 
- The birth of new individuals, depending on the fertility of those already present and their number; 
- mortality, which may depend on predation, disease or old age ; 
- immigration, the rates of which will depend on other populations, their distances from those studied and the dispersal capacity of individuals; 
- emigration, which will depend on the lifestyle of the species studied and its tendency to leave its original population.

 A matrix will allow to represent the population variation according to these four processes.

![Schéma des différentes composantes impactant la dynamique des populations](C:\Users\Laurane\Documents\MODE_reproduciblescience\schéma dyn.png)

These representations can be very complete, including differences in age, gender, genetic origin and other individuals. Indeed, not all individuals will have the same impact on their population dynamics. 
Too young or too old individuals do not participate in reproduction and therefore in the future increase of their group. The number of males will not have the same impact on the number of offspring as the females. 
Finally, individuals of different ages will not have the same mortality rates. Matrices are thus widely used in epidemiology, where they will allow to model the spread of the disease in a population according to the virulence and infectivity of the disease. They may also focus on the population’s response to the disease, depending on individual mortality rates and resilience.

It is important to know that modeling matrices have limitations. They are based in particular on hypotheses that will allow their correct analysis and the validity of their results. Thus, interactions between individuals are not taken into account, and do not affect the dynamics of their population. Then, the caracteristics of individuals of the same class are identical, regardless of the individual, and constant over time. Different caracteristics are only found in different classes.

By allowing to model as correctly as possible the evolution of a population over time, according to the maximum of parameters that can positively or negatively impact it, we can obtain many very interesting results. Thus, population matrices can allow us to improve species conservation and management. Depending on the dynamics of its population, we can know if the species is threatened in the future and/or impacted by events (example: impact of fire). We can have a more global and real vision of how populations evolve in their environment. 
However, matrix models may not be always necessary. As for each study, it is important to ask ourselves the right questions, to think about the interest of this mode of analysis compared to others and its relevance for the question/ population studied.

B) Transformer une population en matrice

We were able to see what are the interests of making population matrices for our research. From now on, we will see together how to create these matrices.

The first thing to do before creating our matrix is to collect data. Scientists regularly conduct long-term monitoring and capture-recapture measurements to obtain maximum information on the population they wish to study. These processes also make it possible to know additional information such as the age of individuals and their gender for example.

It is necessary to know the different parameters that we will apply to our population dynamics. Thus, as we saw earlier, the population evolves according to four main concepts: births, deaths, immigration and emigration. 

In order to correctly model the population that we study, we must be able to express these phenomena in the matrix. For this, we need to know how many individuals die, are born, immigrate or emigrate. These numbers will depend of the species but also on the individuals already present in the population. 
To represent births, we must know the fertility rate of the females already present: in short, how many females, how many young on average, which females are able to reproduce and how many females will be fertilized. 
Then, to represent the death of individuals we must know the mortality (or survival) rate of individuals in this population. It will depend on the composition of our population such as the age of its individuals, the average lifespan of the species and the rates of predation or death by disease for example. 
In terms of immigration rates, they will depend (as mentioned earlier in the first part) on the presence and distance of other populations around and the faculty/tendency of dispersal of the species. 
Finally, emigration rates will be based similarly on the same things, and also depend on the individuals already present.

To have all these parameters, we must already know a minimum of things about the species/population studied. These information can be retrieved during the population study project or in the literature, depending on what we want to study. 

Obviously, depending on the question and the complexity of the study, these parameters may be more or less precise (for example, population of an invasive species with no predator, and therefore a mortality rate dependent on fewer factors).

Once all the parameters are known, we can formulate equations reflecting the evolution of the population according to these criteria. It is useful before making our matrix to realize a life cycle diagram of the studied population.

To help you understand how matrix modeling of populations works, we will use an example more and more complex of a population matrix throughout our chapter.

We will take a population of meerkats as an example. Meerkats are a social species living in more or less numerous groups, with all kinds of individuals of different sex and age. They are also animals able to change groups by leaving theirs or by integrating a new one if the conditions oblige it. Finally, they are under pressure from different predators and potential diseases. Therefore, they will perfectly allow us to represent our population matrices with a maximum of criteria.

To start, we will begin with a very simplified situation:

A serious epidemic decimated the original colony of a meerkat family, forcing them to immigrate to find a new one. The family is healthy and does not have the disease. It is composed of a male and a female, as well as their two young, a young male and a young female. 
If we look for the lifestyle of meerkats in the literature, we obtain in particular that females have 2 to 5 young per year, twice a year. They can have young from one year old.
In our example, we will consider an average of 7 cubs per year. In addition, individuals live on average 12 years. 
                                                                           
We can represent our small, simplified population in a basic matrix form. Thus:

$$     
begin{table}
  \centering
  \caption{Tableau Sexe et Âge}
  \begin{tabular}{|c|c|c|}
    \hline
    \multicolumn{2}{|c|}{Sexe\Age} & \\
    \hline
    & Adulte & Jeune \\
    \hline
    Mâle & M1 & M2 \\
    \hline
    Femelle & F1 & F2 \\
    \hline
  \end{tabular}
\end{table}
$$  

$$       
\begin{equation}   
  P_1 = \begin{bmatrix} M_1 & M_2 \\ F_1 & F_2 \end{bmatrix}  
\end{equation}    
$$      

In practice, it is rather rare to consider both sexes in population matrices. This is due to the greater complexity it would require to also consider gender interactions. For simplicity, the models are often based on females only (female-based model), mainly because of the importance of females for the number of descendants and the greater ease in calculating their number of descendants, compared to a male.

We will now see how to represent our population matrix on R, which will be our main tool in this chapter to manipulate and understand the dynamics of our population. To create a matrix similar to the one shown above, simply type this command:

matrix(nrow = number of rows desired , ncol = number of columns desired) thus in our case:

```{r}
matrix(nrow = 2, ncol = 2)
```

For now, this matrix is empty. If we wanted to fill it directly, we could also use a vector as information: 

```{r}
matrix(data = c(1, 1, 1, 1) , nrow = 2)
```
We could also make a matrix with our abbreviations if we wanted:

```{r}
matrix(data = c("M1 "  , "F1 " , "M2" , "F2 " ), nrow = 2)
```
Finally, we can create a matrix from a list, which can be very convenient if our data set, our population, is represented in this form. In our current case, our list would be very simple since we only have four values. But this makes it easier to write our matrix if our list is much longer.

```{r}
liste <- list(1, 1, 1, 1)    
#ou alors
liste2 <- list("M1 "  , "F1 " , "M2 " , "F2 " )
matrix <- matrix(data = liste, nrow = 2)
matrix
#ou
matrix2 <- matrix(data = liste2, nrow = 2)
matrix2

```
Here, our model represents a stable population, at the moment t. It does not allow us to observe its evolution for the moment. In order to use it in population dynamics, we will have to make it more complex.


C) Comment modifier une matrice basique ?

Before making our matrix suitable for the study of population dynamics, we will start by seeing how simple matrix manipulations can allow us to modify the matrix representation of our population if the latter is modified. 
Let’s take our family of meerkats: during the journey, the young male is captured by a predator, which removes a member from the population and therefore changes the matrix. Similarly, later on, a lone male, lost, is welcomed by the family. Thus, our matrix will be successively modified in these ways: 

$$
\begin{equation}
  P_2 = \begin{bmatrix} M_1 & M_2 \\ F_1 & F_2 \end{bmatrix} - \begin{bmatrix} 0 & M_2 \\ 0 & 0 \end{bmatrix} = \begin{bmatrix} M_1-0 & M_2-M_2 \\ F_1-0 & F_2-0 \end{bmatrix} = \begin{bmatrix} M_1 & 0 \\ F_1 & F_2 \end{bmatrix}
\end{equation}
$$
$$
\begin{equation}
  P_3 = \begin{bmatrix} M_1 & 0 \\ F_1 & F_2 \end{bmatrix} + \begin{bmatrix} M_1 & 0 \\ 0 & 0 \end{bmatrix} = \begin{bmatrix} M_1+M_1 & 0 \\ F_1+0 & F_2+0 \end{bmatrix} = \begin{bmatrix} 2M_1 & 0 \\ F_1 & F_2 \end{bmatrix}
\end{equation}
$$
Thus, our final matrix represents our final population : two adult males, one young female and one adult female, with zero young males. The matrix does not represent each individual personally but the size of each group (adult male, adult female, young male, young female). It is important to remember that we can only add or subtract matrices with the same dimension.

Subsequently, our new family finally joined a large group of meerkats residing in the area. This colony has 30 individuals, whose composition is revealed in the following matrix:

$$
\begin{equation}
  P_n = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix}
\end{equation}
$$

If we compile our two populations, we get our final population which is composed of 34 individuals:

$$
\begin{equation}
  P = \begin{bmatrix} 13M_1 & 3M_2 \\ 15F_1 & 3F_2 \end{bmatrix}
\end{equation}
$$

It is from this population that we will develop the rest of our chapter, which will explain how we can study the evolution of this group over time, according to different parameters. 

If we want to perform these calculations on R, the commands are quite simple. We have seen in the previous part how to create matrices on the software. If we want to compile them, just use the operation «+» or «-» as numbers. Of course, it is also necessary here to have matrices of the same dimension.

```{r}
P1 <- matrix(data = c(1, 1, 1, 1) , nrow = 2)
M <- matrix(data = c(1, 1, 0, 1) , nrow = 2)
P2 = P1 - M
P2

N <- matrix(data = c(1, 0, 0, 0) , nrow = 2)
P3 <- P2 + N
P3

Pn <- matrix(data = c(11, 14, 3, 2) , nrow = 2)
P = P3 + Pn
P



```
Subsequently, we will need to multiply our population matrix with other matrices in order to make it evolve over time. So we will take advantage of this chapter to show you now how to do this. Once again, we will start by reviewing the calculation rules of matrices, then their applications in R. First, to multiply two matrices, they do not have to have the same dimension, unlike addition and subtraction operations. However, the number of columns in the first matrix must be equal to the number of rows in the second. Indeed, the multiplication of the two matrices will be a cross of the columns of one with the rows of the other, so it is important to have an equivalent number between the two. Let’s take the example of Pn, with a lambda B matrix for the moment. We will see in the next chapter which matrix is useful to multiply in reality with our population matrix.

$$
\begin{equation}
  P_n \mathbf{B} = \mathbf{P'}\mathbf{B} = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} * \begin{bmatrix} a & c \\ b & d \end{bmatrix}
\end{equation}
$$

$$
\begin{equation}
  \mathbf{P'}\mathbf{B} = \begin{bmatrix} 11M_1 \ast a + 3M_2 \ast b & 11M_1 \ast c + 3M_2 \ast d \\ 14F_1 \ast a + 2F_2 \ast b & 14F_1 \ast c + 2F_2 \ast d \end{bmatrix}
\end{equation}
$$

As mentioned just before, matrices are not necessarily of the same dimension:

$$
\begin{equation}
  P_n \mathbf{N} = \mathbf{P'}\mathbf{N} = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} * \begin{bmatrix} a \\ b \end{bmatrix}
\end{equation}
$$

$$
\begin{equation}
  P_n \mathbf{N} = \begin{bmatrix} 11M_1 \ast a + 3M_2 \ast b \\ 14F_1 \ast a + 2F_2 \ast b \end{bmatrix}
\end{equation}
$$


It is important to note that most of the time, multiplications are not commutative: we do not get the same result by doing Pn x B as by doing B x Pn. The order of multiplication is important, on the contrary of the multiplication of numbers that can be reversed as desired.

$$
\begin{equation}
  \mathbf{B} \times P_n = \begin{bmatrix} a & c \\ b & d \end{bmatrix} \times \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} = \begin{bmatrix} a \ast 11M_1 + c \ast 14F_1 & a \ast 3M_2 + c \ast 2F_2 \\ b \ast 11M_1 + d \ast 14F_1 & b \ast 3M_2 + d \ast 2F_2 \end{bmatrix}
\end{equation}
$$

Now that the matrix product calculations necessary for our future models are generally acquired, we will see how to perform them on R. If we simply want to multiply our matrix with a number, the sign “*” is enough:

$$
\begin{equation}
  P_m = 2 \times P_n
\end{equation}
$$

If we want to multiply several matrices together, we must add the symbol ‘%’ for each matrix, in addition to ‘*’. Thus:

```{r}
N <- matrix(data = c(2, 4) , nrow = 2)
Pf = Pn % * % N 

```



=======
---
title: "Modèle matrice et applications en écologie"
bibliography: "Quentin, Alexie, Jeanne et Laurane"
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---
I. Foundations of matrix modelling in ecology

	A. Why using matrix modelling in ecology ? 
	
Matrices are mathematical tools for modeling situations. Used in many fields, ecology is no exception . Matrices make it possible to represent populations and make them evolve according to different rules or events. 
The first uses of these models date back to 1941 by Harro Bernardelli which studied the oscillations of the structure of a population (Smith D. and Keyfitz N., 2012). Others use later matrices to represent populations, including Leslie in 1945 whose work marked a turning point in the use of matrices in ecology (Charles S., 2004). 
Subsequently, different models of matrix representation of populations were published and used in population dynamics.

The objective of a population matrix is, as we have already said, to represent the evolution of a population over time and its state at a particular time "t" for example, which will be represented as discreet in this chapter. 
This matrix is therefore based on population growth behaviours. Let’s recall the basics to better understand how population matrices were created :

In 1798, Malthus published his population growth model. If we consider N(t) as the population size at time t, and λ the rate of growth of this population, we can write that: 

$$
N(t+1) = λN(t)
$$
If we want to write this equation for the population in a distant future, we can find by recurrence that :

$$
N(t) = λ^tN(0)   
$$
with N(0) the population at the beginning of our study.

Depending on the sign of λ, our population will therefore increase or decrease over time (Hoppensteadt F.C., 1982).
However, this model is largely simplified. Why? It considers that all individuals are identical, whether by their reproductive capacity or their ability to survive. 
This means that in this model, an elderly individual can reproduce and survive just as well as a young and vigorous individual who has just reached sexual maturity ((Frisman E.Ya. et al., 2021).

But then, how can we solve this problem? In the wild, each individual is different, but we can predict his qualities according to the average of his species and his position in the population: by position, we mean his place in different categories expressed according to various criteria such as age (young, adult, old), sex (male, female), or many others. 
These categories are commonly referred to as “classes”. Several individuals of the same class will have the same characteristics from the point of view of the criterion used for this class, and therefore will have the same impacts on the dynamics of their population. For example, they will have the same fertility or the same survival rate. Thus, we can determine the contribution of each class to another class and thus ultimately to the population, and this according to the size of the first class. 

The size of a class "i" can thus be written:

$$
\begin{equation*}
n_i(t+1) = \sum_j (a_{ij} \cdot n_j(t))
\end{equation*}
$$ 

Where "a" is the contribution and a_ij the contribution of a class "j" to class "i" at time t+1.
We can then create a system considering all the classes, which can be translated into a matrix:

$$
\begin{equation}
N(t+1) = A \cdot N(t)
\end{equation}
$$  
$$
\begin{equation}
N(t) = A^t \cdot N(0)
\end{equation}
$$ 
Where A is what we call a population projection matrix, representing our population in a matrix form, according to its different characteristics (classes, class parameters, etc.). 
N(t) is a vector dependent on the number of individuals present in our population, and N(0) is our initial population vector, from which we will be able to make this population evolve over time.

Population dynamic is a concept that is sometimes difficult to study because it depends on many parameters. A population will vary in size and type of individuals through four main processes: 
- The birth of new individuals, depending on the fertility of those already present and their number; 
- mortality, which may depend on predation, disease or old age ; 
- immigration, the rates of which will depend on other populations, their distances from those studied and the dispersal capacity of individuals; 
- emigration, which will depend on the lifestyle of the species studied and its tendency to leave its original population.

 A matrix will allow to represent the population variation according to these four processes (Schaub M. and Abadi F., 2011 ; Abadi et al., 2010).

 (mettre ta figure)

These representations can be very complete, including differences in age, gender, genetic origin and other individuals. Indeed, not all individuals will have the same impact on their population dynamics. 
Too young or too old individuals do not participate in reproduction and therefore in the future increase of their group. The number of males will not have the same impact on the number of offspring as the females. 
Finally, individuals of different ages will not have the same mortality rates. Matrices are thus widely used in epidemiology, where they will allow to model the spread of the disease in a population according to the virulence and infectivity of the disease. They may also focus on the population’s response to the disease, depending on individual mortality rates and resilience.

It is important to know that modeling matrices have limitations. They are based in particular on hypotheses that will allow their correct analysis and the validity of their results. Thus, interactions between individuals are not taken into account, and do not affect the dynamics of their population. Then, the caracteristics of individuals of the same class are identical, regardless of the individual, and constant over time. Different caracteristics are only found in different classes.

By allowing to model as correctly as possible the evolution of a population over time, according to the maximum of parameters that can positively or negatively impact it, we can obtain many very interesting results. Thus, population matrices can allow us to improve species conservation and management. Depending on the dynamics of its population, we can know if the species is threatened in the future and/or impacted by events (example: impact of fire (Hoffmann W.A., 1999)). We can have a more global and real vision of how populations evolve in their environment. 
However, matrix models may not be always necessary. As for each study, it is important to ask ourselves the right questions, to think about the interest of this mode of analysis compared to others and its relevance for the question/ population studied.

B) Transform a population into a matrix

We were able to see what are the interests of making population matrices for our research. From now on, we will see together how to create these matrices.

The first thing to do before creating our matrix is to collect data. Scientists regularly conduct long-term monitoring and capture-recapture measurements to obtain maximum information on the population they wish to study. These processes also make it possible to know additional information such as the age of individuals and their gender for example.

It is necessary to know the different parameters that we will apply to our population dynamics. Thus, as we saw earlier, the population evolves according to four main concepts: births, deaths, immigration and emigration. 

In order to correctly model the population that we study, we must be able to express these phenomena in the matrix. For this, we need to know how many individuals die, are born, immigrate or emigrate. These numbers will depend of the species but also on the individuals already present in the population. 
To represent births, we must know the fertility rate of the females already present: in short, how many females, how many young on average, which females are able to reproduce and how many females will be fertilized. 
Then, to represent the death of individuals we must know the mortality (or survival) rate of individuals in this population. It will depend on the composition of our population such as the age of its individuals, the average lifespan of the species and the rates of predation or death by disease for example. 
In terms of immigration rates, they will depend (as mentioned earlier in the first part) on the presence and distance of other populations around and the faculty/tendency of dispersal of the species. 
Finally, emigration rates will be based similarly on the same things, and also depend on the individuals already present.

To have all these parameters, we must already know a minimum of things about the species/population studied. These information can be retrieved during the population study project or in the literature, depending on what we want to study. 

Obviously, depending on the question and the complexity of the study, these parameters may be more or less precise (for example, population of an invasive species with no predator, and therefore a mortality rate dependent on fewer factors).

Once all the parameters are known, we can formulate equations reflecting the evolution of the population according to these criteria. It is useful before making our matrix to realize a life cycle diagram of the studied population (Charles S., 2004).

To help you understand how matrix modeling of populations works, we will use an example more and more complex of a population matrix throughout our chapter.

We will take a population of meerkats as an example. Meerkats are a social species living in more or less numerous groups, with all kinds of individuals of different sex and age. They are also animals able to change groups by leaving theirs or by integrating a new one if the conditions oblige it. Finally, they are under pressure from different predators and potential diseases. Therefore, they will perfectly allow us to represent our population matrices with a maximum of criteria.

To start, we will begin with a very simplified situation:

A serious epidemic decimated the original colony of a meerkat family, forcing them to immigrate to find a new one. The family is healthy and does not have the disease. It is composed of a male and a female, as well as their two young, a young male and a young female. 
If we look for the lifestyle of meerkats in the literature, we obtain in particular that females have 2 to 5 young per year. They can have young from one year old.
In our example, we will consider an average of 3 cubs per year. In addition, individuals live on average 12 years (Réserve de Sigean, 2023). 
                                                                           
We can represent our small, simplified population in a basic matrix form. Thus:

$$     
begin{table}
  \centering
  \caption{Tableau Sexe et Âge}
  \begin{tabular}{|c|c|c|}
    \hline
    \multicolumn{2}{|c|}{Sexe\Age} & \\
    \hline
    & Adulte & Jeune \\
    \hline
    Mâle & M1 & M2 \\
    \hline
    Femelle & F1 & F2 \\
    \hline
  \end{tabular}
\end{table}
$$  

$$       
\begin{equation}   
  P_1 = \begin{bmatrix} M_1 & M_2 \\ F_1 & F_2 \end{bmatrix}  
\end{equation}    
$$      

In practice, it is rather rare to consider both sexes in population matrices. This is due to the greater complexity it would require to also consider gender interactions. For simplicity, the models are often based on females only (female-based model), mainly because of the importance of females for the number of descendants and the greater ease in calculating their number of descendants, compared to a male (Girel S., 2020 ; ) .

We will now see how to represent our population matrix on R, which will be our main tool in this chapter to manipulate and understand the dynamics of our population. To create a matrix similar to the one shown above, simply type this command:

matrix(nrow = number of rows desired , ncol = number of columns desired) thus in our case:

```{r}
matrix(nrow = 2, ncol = 2)
```

For now, this matrix is empty. If we wanted to fill it directly, we could also use a vector as information: 

```{r}
matrix(data = c(1, 1, 1, 1) , nrow = 2)
```
We could also make a matrix with our abbreviations if we wanted:

```{r}
matrix(data = c("M1 "  , "F1 " , "M2" , "F2 " ), nrow = 2)
```
Finally, we can create a matrix from a list, which can be very convenient if our data set, our population, is represented in this form. In our current case, our list would be very simple since we only have four values. But this makes it easier to write our matrix if our list is much longer.

```{r}
liste <- list(1, 1, 1, 1)    
#ou alors
liste2 <- list("M1 "  , "F1 " , "M2 " , "F2 " )
matrix <- matrix(data = liste, nrow = 2)
matrix
#ou
matrix2 <- matrix(data = liste2, nrow = 2)
matrix2

```
Here, our model represents a stable population, at the moment t. It does not allow us to observe its evolution for the moment. In order to use it in population dynamics, we will have to make it more complex.


C) How can we modify a simplified population matrix ?

Before making our matrix suitable for the study of population dynamics, we will start by seeing how simple matrix manipulations can allow us to modify the matrix representation of our population if the latter is modified. 
Let’s take our family of meerkats: during the journey, the young male is captured by a predator, which removes a member from the population and therefore changes the matrix. Similarly, later on, a lone male, lost, is welcomed by the family. Thus, our matrix will be successively modified in these ways: 

$$
\begin{equation}
  P_2 = \begin{bmatrix} M_1 & M_2 \\ F_1 & F_2 \end{bmatrix} - \begin{bmatrix} 0 & M_2 \\ 0 & 0 \end{bmatrix} = \begin{bmatrix} M_1-0 & M_2-M_2 \\ F_1-0 & F_2-0 \end{bmatrix} = \begin{bmatrix} M_1 & 0 \\ F_1 & F_2 \end{bmatrix}
\end{equation}
$$
$$
\begin{equation}
  P_3 = \begin{bmatrix} M_1 & 0 \\ F_1 & F_2 \end{bmatrix} + \begin{bmatrix} M_1 & 0 \\ 0 & 0 \end{bmatrix} = \begin{bmatrix} M_1+M_1 & 0 \\ F_1+0 & F_2+0 \end{bmatrix} = \begin{bmatrix} 2M_1 & 0 \\ F_1 & F_2 \end{bmatrix}
\end{equation}
$$
Thus, our final matrix represents our final population : two adult males, one young female and one adult female, with zero young males. The matrix does not represent each individual personally but the size of each group (adult male, adult female, young male, young female). It is important to remember that we can only add or subtract matrices with the same dimension.

Subsequently, our new family finally joined a large group of meerkats residing in the area. This colony has 30 individuals, whose composition is revealed in the following matrix:

$$
\begin{equation}
  P_n = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix}
\end{equation}
$$

If we compile our two populations, we get our final population which is composed of 34 individuals:

$$
\begin{equation}
  P = \begin{bmatrix} 13M_1 & 3M_2 \\ 15F_1 & 3F_2 \end{bmatrix}
\end{equation}
$$

It is from this population that we will develop the rest of our chapter, which will explain how we can study the evolution of this group over time, according to different parameters. 

If we want to perform these calculations on R, the commands are quite simple. We have seen in the previous part how to create matrices on the software. If we want to compile them, just use the operation «+» or «-» as numbers. Of course, it is also necessary here to have matrices of the same dimension.

```{r}
P1 <- matrix(data = c(1, 1, 1, 1) , nrow = 2)
M <- matrix(data = c(1, 1, 0, 1) , nrow = 2)
P2 = P1 - M
P2

N <- matrix(data = c(1, 0, 0, 0) , nrow = 2)
P3 <- P2 + N
P3

Pn <- matrix(data = c(11, 14, 3, 2) , nrow = 2)
P = P3 + Pn
P



```
Subsequently, we will need to multiply our population matrix with other matrices in order to make it evolve over time. So we will take advantage of this chapter to show you now how to do this. Once again, we will start by reviewing the calculation rules of matrices, then their applications in R. First, to multiply two matrices, they do not have to have the same dimension, unlike addition and subtraction operations. However, the number of columns in the first matrix must be equal to the number of rows in the second. Indeed, the multiplication of the two matrices will be a cross of the columns of one with the rows of the other, so it is important to have an equivalent number between the two. Let’s take the example of Pn, with a lambda B matrix for the moment. We will see in the next chapter which matrix is useful to multiply in reality with our population matrix.

$$
\begin{equation}
  P_n \mathbf{B} = \mathbf{P'}\mathbf{B} = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} * \begin{bmatrix} a & c \\ b & d \end{bmatrix}
\end{equation}
$$

$$
\begin{equation}
  \mathbf{P'}\mathbf{B} = \begin{bmatrix} 11M_1 \ast a + 3M_2 \ast b & 11M_1 \ast c + 3M_2 \ast d \\ 14F_1 \ast a + 2F_2 \ast b & 14F_1 \ast c + 2F_2 \ast d \end{bmatrix}
\end{equation}
$$

As mentioned just before, matrices are not necessarily of the same dimension:

$$
\begin{equation}
  P_n \mathbf{N} = \mathbf{P'}\mathbf{N} = \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} * \begin{bmatrix} a \\ b \end{bmatrix}
\end{equation}
$$

$$
\begin{equation}
  P_n \mathbf{N} = \begin{bmatrix} 11M_1 \ast a + 3M_2 \ast b \\ 14F_1 \ast a + 2F_2 \ast b \end{bmatrix}
\end{equation}
$$


It is important to note that most of the time, multiplications are not commutative: we do not get the same result by doing Pn x B as by doing B x Pn. The order of multiplication is important, on the contrary of the multiplication of numbers that can be reversed as desired.

$$
\begin{equation}
  \mathbf{B} \times P_n = \begin{bmatrix} a & c \\ b & d \end{bmatrix} \times \begin{bmatrix} 11M_1 & 3M_2 \\ 14F_1 & 2F_2 \end{bmatrix} = \begin{bmatrix} a \ast 11M_1 + c \ast 14F_1 & a \ast 3M_2 + c \ast 2F_2 \\ b \ast 11M_1 + d \ast 14F_1 & b \ast 3M_2 + d \ast 2F_2 \end{bmatrix}
\end{equation}
$$

Now that the matrix product calculations necessary for our future models are generally acquired, we will see how to perform them on R. If we simply want to multiply our matrix with a number, the sign “*” is enough:

$$
\begin{equation}
  P_m = 2 \times P_n
\end{equation}
$$

If we want to multiply several matrices together, we must add the symbol ‘%’ for each matrix, in addition to ‘*’. Thus:

```{r}
N <- matrix(data = c(2, 4) , nrow = 2)
Pf = Pn % * % N 

```



>>>>>>> 0534c1dc9a82c4a53eb3721bc805bbd3f29d4b9e
